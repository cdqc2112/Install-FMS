#! /bin/echo not-a-standalone-executable
# shellcheck shell=bash

# shellcheck disable=SC2034  # Variable is exported to other modules
DEFAULT_ENV=()

# Describes every required env variable. Either provide default value, or ! if variable is mandatory.
# This function is autogenerated from example.env
function defaultEnv() {
    DEFAULT_ENV=(
        ROOT_PATH=/opt/fms/solution
        MASTER_ROOT_PATH=/opt/fms/master
        LOG_DIR=/logs
        LOG_DIR_MOD=750
        RTU=/rtu
        RTU_UPDATES_LOGS=/rtu_updates
        RTU_GENERAL_LOGS=/rtu_general
        ALARM_LOG=/alarming
        MEASUREMENT_HANDLER_LOG=/measurement_handler
        RTU_BROKER=/rtu_broker
        TOPOLOGY_LOG=/topology_api
        KEYCLOAK_LOG=/keycloak
        PROXY_LOG=/proxy
        FILE_REPLICATION_LOG=/file_replication
        ALARMING_METRICS_PROXY_LOG=/metric_proxy
        RTU_API_GATEWAY=/rtu_api_gateway
        PERSISTENT_DATA_DIR=/data
        SECURITY_DATA=/security
        TOPOLOGY_DATA=/topology
        MEASUREMENT_DATA=/measurement
        FILE_DATA=/files
        ALARM_DATA=/alarms
        ALARMING_METRICS_DATA=/prometheus
        TOPOLOGY_UI_DATA=/topology_ui
        FILE_REPLICATION_DATA=/file_replication
        RTU_VERSION_CONTROLLER=/rtu_version_controller
        DISTRIBUTION_DATA=/dist
        METRIC_DATA=/metric
        VICTORIA_METRICS_DATA=/victoria-metrics
        RTU_LOG_COLLECTOR=/rtu_log_collector
        CONFIG=/config
        KEYCLOAK_CONFIG=/keycloak
        RTU_NTP_SERVER=pool.ntp.org
        ROOT_DNS=!
        TOPOLOGY_API_DNS=!
        ALARM_DNS=!
        KEYCLOAK_DNS=!
        TOPOLOGY_UI_DNS=!
        DATA_DNS=!
        MESSAGE_DNS=!
        KEYCLOAK_MASTER_ADMIN_USER_INIT=
        KEYCLOAK_MASTER_ADMIN_USER_INIT_SECRET=
        KEYCLOAK_TOPOLOGY_MASTER_SECURE=true
        KEYCLOAK_FIBER_ADMIN_USER_INIT=
        KEYCLOAK_FIBER_ADMIN_USER_INIT_SECRET=
        KEYCLOAK_FIBER_TEST_USER_INIT=
        KEYCLOAK_FIBER_TEST_USER_INIT_SECRET=
        KEYCLOAK_DB_PASSWORD_SECRET=!
        PROXY_SESSION_SECRET=!
        TOPOLOGY_DB_PASSWORD_SECRET=!
        IAM_SERVER=!
        IAM_TYPE=KEYCLOAK
        IAM_IAT_SLACK_SEC=120
        IAM_CLIENT_ID=fg-topologyapi
        IAM_CLIENT_SECRET=!
        IAM_SERVICE_AUTHORIZATION_PROXY_CLIENT_ID=fg-service-authorization-proxy
        IAM_SERVICE_AUTHORIZATION_PROXY_CLIENT_SECRET=!
        SERVER_CERT_SECRET=
        SERVER_CERT_KEY_SECRET=
        FGMS_TRUSTSTORE_SECRET=
        FGMS_TRUSTSTORE_PASSWD_SECRET=
        RTU_SSL_AUTH_REQUIRED=false
        RTU_SSL_AUTH_TRUSTSTORE_FILE_SECRET=
        RTU_SSL_AUTH_TRUSTSTORE_PASSWD_SECRET=
        RTU_SSL_AUTH_CERT_DN_REGEXP=
        TLS_VERSION=TLSv1.2,TLSv1.3
        BROKER_TLS13_CIPHER_SUITES=TLS_CHACHA20_POLY1305_SHA256,TLS_AES_128_GCM_SHA256,TLS_AES_256_GCM_SHA384
        BROKER_TLS12_CIPHER_SUITES=TLS_DHE_DSS_WITH_AES_128_GCM_SHA256,TLS_DHE_DSS_WITH_AES_256_GCM_SHA384,TLS_DHE_RSA_WITH_AES_128_GCM_SHA256,TLS_DHE_RSA_WITH_AES_256_GCM_SHA384,TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256
        PROXY_TLS13_CIPHER_SUITES=TLS_AES_128_CCM_8_SHA256:TLS_AES_128_CCM_SHA256:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384
        PROXY_TLS12_CIPHER_SUITES=DHE-RSA-AES128-CCM:ECDHE-ECDSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:ECDHE-PSK-CHACHA20-POLY1305:DHE-PSK-AES128-GCM-SHA256:DHE-PSK-CHACHA20-POLY1305:TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_GCM_SHA256:TLS_DHE_DSS_WITH_ARIA_128_GCM_SHA256:DHE-RSA-AES256-CCM8:TLS_DHE_RSA_WITH_CAMELLIA_128_GCM_SHA256:TLS_DHE_DSS_WITH_ARIA_256_GCM_SHA384:TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_GCM_SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-CCM:TLS_ECDHE_RSA_WITH_ARIA_256_GCM_SHA384:DHE-RSA-AES256-CCM:TLS_DHE_PSK_WITH_CAMELLIA_256_GCM_SHA384:TLS_ECDHE_RSA_WITH_ARIA_128_GCM_SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:DHE-PSK-AES128-CCM8:TLS_ECDHE_ECDSA_WITH_ARIA_256_GCM_SHA384:DHE-PSK-AES256-CCM:TLS_DHE_PSK_WITH_ARIA_256_GCM_SHA384:TLS_ECDHE_RSA_WITH_CAMELLIA_256_GCM_SHA384:TLS_DHE_RSA_WITH_ARIA_128_GCM_SHA256:ECDHE-ECDSA-AES128-CCM8:DHE-DSS-AES128-GCM-SHA256:TLS_DHE_PSK_WITH_CAMELLIA_128_GCM_SHA256:TLS_ECCPWD_WITH_AES_128_CCM_SHA256:TLS_ECDHE_PSK_WITH_AES_128_CCM_8_SHA256:DHE-RSA-CHACHA20-POLY1305:ECDHE-RSA-AES256-GCM-SHA384:TLS_DHE_DSS_WITH_CAMELLIA_128_GCM_SHA256:TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256:TLS_ECCPWD_WITH_AES_256_CCM_SHA384:DHE-DSS-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-CCM8:TLS_ECDHE_PSK_WITH_AES_128_CCM_SHA256:DHE-PSK-AES256-GCM-SHA384:DHE-PSK-AES256-CCM8:DHE-RSA-AES128-CCM8:TLS_ECCPWD_WITH_AES_128_GCM_SHA256:ECDHE-RSA-CHACHA20-POLY1305:TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:TLS_ECDHE_RSA_WITH_CAMELLIA_128_GCM_SHA256:TLS_ECCPWD_WITH_AES_256_GCM_SHA384:TLS_ECDHE_ECDSA_WITH_ARIA_128_GCM_SHA256:TLS_DHE_DSS_WITH_CAMELLIA_256_GCM_SHA384:TLS_DHE_RSA_WITH_CAMELLIA_256_GCM_SHA384:ECDHE-ECDSA-AES128-CCM:ECDHE-RSA-AES128-GCM-SHA256:TLS_DHE_PSK_WITH_ARIA_128_GCM_SHA256:DHE-PSK-AES128-CCM:TLS_DHE_RSA_WITH_ARIA_256_GCM_SHA384
        MONGO_USERNAME_MEASURE=OpticalMaster
        MONGO_PASSWORD_MEASURE_SECRET=!
        MONGO_MEASURE_REPLICATION_TOKEN_SECRET=
        MONGO_USERNAME_ALARMING=OpticalMaster
        MONGO_PASSWORD_ALARMING_SECRET=!
        MONGO_ALARM_REPLICATION_TOKEN_SECRET=
        ALARMING_CONFIG_SNMP_FILE_SECRET=
        ALARMING_CONFIG_EMAIL_FILE_SECRET=
        MONGO_USERNAME_ALARMING_METRICS=OpticalMaster
        MONGO_PASSWORD_ALARMING_METRICS_SECRET=!
        MONGO_USERNAME_RTU_API_GATEWAY=OpticalMaster
        MONGO_PASSWORD_RTU_API_GATEWAY_SECRET=!
        EDITION=FGMS
        ALARM_AUTO_REFRESH_INTERVAL=30
        ALARM_UNSHELVING_INTERVAL_IN_MINUTES=60
        SNMP_IMPLEMENTATION_VERSION=0
        IS_CLEAR_SEVERITY_USED=true
        REPLICATION_ROOT_PATH=/opt/fms/replication
        REPLICATION_DATA_DIR=/replicated_data
        BACKUP_DIR=/backup
        LATEST_DIR=/latest
        HISTORY_DIR=/history
        REPLICATION_ENABLED=false
        FILE_REPLICATION_PERIODICITY=3600
        FILE_REPLICATION_RETRY=60
        FILE_REPLICATION_SECRET=
        FMS_BACKUP_SCRIPT_DIR=/deployment/backup
        BACKUP_ALERT_SCRIPT_PATH=/opt/fms/master/deployment/backup/client-script-example.sh
        ALERT_SCRIPT_PATH=/opt/fms/master/deployment/backup/send-alert.sh
        BACKUP_LOG_FULL_PATH=/opt/fms/master/logs/backup/backupLog.log
        MAX_BACKUP_ALLOW=2
        PROXY_LOG_EXPIRATION_PERIOD=62
        RTU_AUDIT_LOG_EXPIRATION_PERIOD=62
        KEYCLOAK_LOG_EXPIRATION_PERIOD_DAYS=62
        RTU_CONFIGURATION_VALIDATOR_SERVICE_ENABLED=true
        JOLOKIA_USER=admin
        JOLOKIA_PASSWORD_SECRET=!
        RTU_BROKER_ADMIN_PASSWORD_SECRET=!
        RTU_BROKER_MAX_BROWSE_PAGE_SIZE=2000
        RTU_BROKER_MAX_CONNECTIONS=5000
        RTU_BROKER_EXPIRATION_TIMESTAMP_PERIOD=14400000
        RTU_BROKER_DLQ_EXPIRATION=864000000
        REMOTE_LOG_BLACKLIST=
        ROOT_SQUASH=
        KEYCLOAK_UID_GID=1000:1000
        MEASUREMENT_FILE_UID_GID=1001:1001
        MEASUREMENT_UID_GID=1002:1002
        MEASUREMENT_HANDLER_UID_GID=1003:1003
        RTU_VERSION_CONTROLLER_UID_GID=1004:1004
        ALARMING_METRICS_UID_GID=1005:1005
        OPTICAL_PROCESSING_UID_GID=1006:1006
        RTU_CONFIGURATION_VALIDATOR_UID_GID=1007:1007
        ALARMING_UID_GID=1008:1008
        TOPOLOGY_API_UID_GID=1009:1009
        ALERTMANAGER_UID_GID=1010:1010
        PROXY_UID_GID=1011:1011
        PROXY_EFFECTIVE_UID_GID=1011:1011
        TOPOLOGY_UI_UID_GID=1012:1012
        RTU_BROKER_UID_GID=1013:1013
        ALARMING_METRICS_PROXY_UID_GID=1014:1014
        RTU_API_GATEWAY_UID_GID=1016:1016
        CONDUCTOR_CEREBRO_UID_GID=1018:1018
        CONDUCTOR_ELASTICSEARCH_UID_GID=1019:1019
        CONDUCTOR_SERVER_UID_GID=1020:1020
        CONDUCTOR_UI_UID_GID=1021:1021
        CONFIG_REPLICATION_UID_GID=1022:1022
        KEYCLOAK_PROXY_UID_GID=1023:1023
        VICTORIA_METRICS_UID_GID=1024:1024
        RTU_LOG_COLLECTOR_UID_GID=1025:1025
        SERVICE_AUTHORIZATION_PROXY_UID_GID=1026:1026
        CONDUCTOR_DB_PASSWORD_SECRET=!
        CONDUCTOR_DATA=/conductor
        CONDUCTOR_CEREBRO=/conductor-cerebro
        CONDUCTOR_ELASTICSEARCH=/conductor-es
        RTU_VERSION_CONTROLLER_TOKEN_SECRET=!
        EXPOSE_DEV_PORT=false
        MEMORY_LIMIT_MONGODB_MEASDATA_MO=1024
        MEMORY_LIMIT_MONGODB_ALARMING_MO=1024
        MEMORY_LIMIT_MONGODB_ALARMINGMETRICSPROXY_MO=1024
        MEMORY_LIMIT_MONGODB_RTUAPIGATEWAY_MO=1024
        MEMORY_LIMIT_TOPOLOGYAPI_MO=
        MEMORY_LIMIT_RTUBROKER_MO=
        MEMORY_LIMIT_MEASHANDLER_MO=
        MEMORY_LIMIT_ALARMINGMETRICS_MO=
        MEMORY_LIMIT_VICTORIA_METRICS_MO=1024
        VICTORIA_METRICS_RETENTION_PERIOD_MONTHS=12
        ORCHESTRATOR=swarm
        MONGO_MEASUREMENT_DATA_MAX_SORT_RAM_BUFFER_SIZE=335544320
        MONGO_ALARMING_DATA_MAX_SORT_RAM_BUFFER_SIZE=335544320
        MONGO_ALARMING_METRICS_PROXY_DATA_MAX_SORT_RAM_BUFFER_SIZE=335544320
        MONGO_RTU_API_GATEWAY_DATA_MAX_SORT_RAM_BUFFER_SIZE=335544320
    )
}



function defaultSecrets() {
    SECRETS_WITH_DEFAULT_INIT+=(
                        "PROXY_SESSION_SECRET proxy-session-secret 64"
                        "TOPOLOGY_DB_PASSWORD_SECRET topology-postgres-passwd-secret"
                        "KEYCLOAK_DB_PASSWORD_SECRET keycloak-postgres-passwd-secret"
                        "MONGO_PASSWORD_MEASURE_SECRET mongo-passwd-measure-secret"
                        "MONGO_PASSWORD_ALARMING_SECRET mongo-passwd-alarming-secret"
                        "MONGO_PASSWORD_ALARMING_METRICS_SECRET mongo-passwd-alarming-metrics-secret"
                        "MONGO_PASSWORD_RTU_API_GATEWAY_SECRET mongo-passwd-rtu-api-gateway-secret"
                        "CONDUCTOR_DB_PASSWORD_SECRET conductor-postgres-passwd-secret"
                        "RTU_VERSION_CONTROLLER_TOKEN_SECRET rtu-version-controller-token-secret 1024"
                        "JOLOKIA_PASSWORD_SECRET jolokia-pwd"
                        "RTU_BROKER_ADMIN_PASSWORD_SECRET rtu-broker-admin-pwd"
                        "IAM_CLIENT_SECRET iam-client-secret"
                        "IAM_SERVICE_AUTHORIZATION_PROXY_CLIENT_SECRET iam-service-authorization-proxy-client-secret"
                        "MONGO_MEASURE_REPLICATION_TOKEN_SECRET --only-if REPLICATION_ENABLED mongo-measure-replication-token-secret 1024"
                        "MONGO_ALARM_REPLICATION_TOKEN_SECRET --only-if REPLICATION_ENABLED mongo-alarm-replication-token-secret 1024"
                        "FILE_REPLICATION_SECRET --only-if REPLICATION_ENABLED --generator secret-generator-rsync file-replication-secret"
    )

    KEYCLOAK_USERS_WITH_DEFAULT_INIT+=(
                        "KEYCLOAK_MASTER_ADMIN_USER_INIT admin"
                        "KEYCLOAK_FIBER_ADMIN_USER_INIT admin"
                        "KEYCLOAK_FIBER_TEST_USER_INIT user"
    )
}
